defradb:
  url: "localhost:9181"
  keyring_secret: "pingpong"
  # P2P Configuration (controlled by NetworkHandler)
  p2p:
    enabled: true
    bootstrap_peers: 
      - '/ip4/136.112.206.228/tcp/9171/p2p/12D3KooWC2A7oX3zq3QLrL3NhrrSrLSxMArHRWQPCZGqF3XzPAYv'
      - '/ip4/34.72.60.210/tcp/9171/p2p/12D3KooWBBeucFveKxPV2PbzXi56ijtXKkiRmTRbb9ELUcEREK4s'
    listen_addr: "/ip4/0.0.0.0/tcp/0"
    # Filter P2P topics - only subscribe to document-related topics
    topic_filter:
      - "Block"
      - "Transaction" 
      - "Log"
      - "AccessListEntry"
      - "AttestationRecord"
  store:
    path: "./.defra/data"
shinzo:
  minimum_attestations: 1
  start_height: 23603421  # Start closer to latest block for testing (was 23500000)
  # web_socket_url: ""  # Commented out to test without shinzohub connection
  
  # P2P Control Settings
  wait_for_gaps: true         # Wait for gap processing before starting P2P
  max_gap_size: 1000          # Skip P2P if gap is larger than this
  
  # Message Cache & Worker Pool Settings - AGGRESSIVE MEMORY PROTECTION
  cache_size: 1000              # CRITICAL: Small cache to prevent memory explosion
  cache_queue_size: 500         # CRITICAL: Small queue to prevent memory explosion  
  cache_max_age_seconds: 10     # CRITICAL: Aggressive cleanup every 10 seconds
  worker_count: 4               # CRITICAL: Fewer workers to prevent goroutine explosion

  # View Management Settings
  view_inactivity_timeout: "24h"  # Stop updating views after 24h of no access
  view_cleanup_interval: "1h"     # Check for inactive views every hour
  view_worker_count: 2            # Workers for lens transformations
  view_queue_size: 1000           # Queue size for view processing jobs

logger:
  development: false
  level: "error"  # Only show errors, suppress all P2P info/warn messages
  # Alternative: Suppress specific P2P logging
  # modules:
  #   p2p: "error"     # Suppress P2P info messages
  #   coreblock: "error" # Suppress DAG head messages

host:
  lens_registry_path: "./.lens"
